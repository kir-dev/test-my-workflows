name: Create a release

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
    release:
      environment: production
      runs-on: ubuntu-latest
            
      steps:
        - name: Checkout repository
          uses: actions/checkout@v4
        - name: Get date
          id: date
          run: echo "::set-output name=date::$(date +'%Y-%m-%d %H:%M:%S')"
        - name: Push to the production tag
          run: |
            git config --local user.email "action@noreply.github.com"
            git config --local user.name "GitHub Action"
            git tag -a production -m "Release ${{ steps.date.outputs.date }}"
            git push origin production